<!doctype html>
<html>
  <head>
    <title>Admin Dashboard - Food Safety Inspector</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        background: #f3f4f6;
        min-height: 100vh;
      }
      .header {
        background: #1E40AF;
        color: white;
        padding: 16px 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      }
      .header-left {
        display: flex;
        align-items: center;
        gap: 12px;
      }
      .header-logo {
        width: 40px;
        height: 40px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .header-logo svg {
        width: 24px;
        height: 24px;
        fill: white;
      }
      .header-title {
        font-size: 18px;
        font-weight: 600;
      }
      .header-subtitle {
        font-size: 12px;
        opacity: 0.8;
      }
      .header-right {
        display: flex;
        align-items: center;
        gap: 16px;
      }
      .admin-badge {
        background: rgba(255, 255, 255, 0.2);
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 500;
      }
      .logout-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        transition: background 0.2s;
      }
      .logout-btn:hover {
        background: rgba(255, 255, 255, 0.2);
      }
      .main {
        padding: 24px;
        max-width: 1400px;
        margin: 0 auto;
      }
      .welcome-section {
        margin-bottom: 32px;
      }
      .welcome-title {
        font-size: 28px;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 4px;
      }
      .welcome-subtitle {
        color: #6b7280;
        font-size: 16px;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
      }
      .stat-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      }
      .stat-card-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 12px;
      }
      .stat-card-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .stat-card-icon svg {
        width: 24px;
        height: 24px;
      }
      .stat-card-icon.blue {
        background: #dbeafe;
      }
      .stat-card-icon.blue svg {
        fill: #1E40AF;
      }
      .stat-card-icon.green {
        background: #d1fae5;
      }
      .stat-card-icon.green svg {
        fill: #059669;
      }
      .stat-card-icon.amber {
        background: #fef3c7;
      }
      .stat-card-icon.amber svg {
        fill: #d97706;
      }
      .stat-card-icon.red {
        background: #fee2e2;
      }
      .stat-card-icon.red svg {
        fill: #dc2626;
      }
      .stat-value {
        font-size: 36px;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 4px;
      }
      .stat-label {
        color: #6b7280;
        font-size: 14px;
      }
      .section-title {
        font-size: 20px;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 16px;
      }
      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
      }
      .action-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        border: 1px solid #e5e7eb;
        transition: border-color 0.2s, box-shadow 0.2s;
        cursor: pointer;
      }
      .action-card:hover {
        border-color: #1E40AF;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.15);
      }
      .action-card-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 12px;
      }
      .action-card-icon {
        width: 48px;
        height: 48px;
        background: #eff6ff;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .action-card-icon svg {
        width: 24px;
        height: 24px;
        fill: #1E40AF;
      }
      .action-card-title {
        font-size: 18px;
        font-weight: 600;
        color: #1f2937;
      }
      .action-card-desc {
        color: #6b7280;
        font-size: 14px;
        line-height: 1.5;
      }
      .coming-soon {
        display: inline-block;
        background: #fef3c7;
        color: #92400e;
        font-size: 11px;
        font-weight: 600;
        padding: 2px 8px;
        border-radius: 4px;
        margin-left: 8px;
      }
      .recent-activity {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        margin-top: 32px;
      }
      .activity-list {
        list-style: none;
      }
      .activity-item {
        display: flex;
        align-items: flex-start;
        gap: 16px;
        padding: 16px 0;
        border-bottom: 1px solid #e5e7eb;
      }
      .activity-item:last-child {
        border-bottom: none;
      }
      .activity-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-top: 6px;
        flex-shrink: 0;
      }
      .activity-dot.blue { background: #1E40AF; }
      .activity-dot.green { background: #059669; }
      .activity-dot.amber { background: #d97706; }
      .activity-content {
        flex: 1;
      }
      .activity-text {
        color: #1f2937;
        font-size: 14px;
        margin-bottom: 4px;
      }
      .activity-time {
        color: #9ca3af;
        font-size: 12px;
      }
      @media (max-width: 768px) {
        .header {
          flex-direction: column;
          gap: 16px;
          text-align: center;
        }
        .header-left {
          flex-direction: column;
        }
        .main {
          padding: 16px;
        }
        .welcome-title {
          font-size: 24px;
        }
      }
    </style>
  </head>
  <body>
    <header class="header">
      <div class="header-left">
        <div class="header-logo">
          <svg viewBox="0 0 24 24">
            <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/>
          </svg>
        </div>
        <div>
          <div class="header-title">Food Safety Inspector</div>
          <div class="header-subtitle">Administration Panel</div>
        </div>
      </div>
      <div class="header-right">
        <span class="admin-badge">Super Admin</span>
        <button class="logout-btn" onclick="logout()">Logout</button>
      </div>
    </header>

    <main class="main">
      <div class="welcome-section">
        <h1 class="welcome-title">Welcome, Administrator</h1>
        <p class="welcome-subtitle">Manage the Food Safety Inspection System</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-card-header">
            <div class="stat-card-icon blue">
              <svg viewBox="0 0 24 24">
                <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
              </svg>
            </div>
          </div>
          <div class="stat-value">24</div>
          <div class="stat-label">Active Officers</div>
        </div>

        <div class="stat-card">
          <div class="stat-card-header">
            <div class="stat-card-icon green">
              <svg viewBox="0 0 24 24">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
              </svg>
            </div>
          </div>
          <div class="stat-value">156</div>
          <div class="stat-label">Total Inspections</div>
        </div>

        <div class="stat-card">
          <div class="stat-card-header">
            <div class="stat-card-icon amber">
              <svg viewBox="0 0 24 24">
                <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
              </svg>
            </div>
          </div>
          <div class="stat-value">43</div>
          <div class="stat-label">Samples in Transit</div>
        </div>

        <div class="stat-card">
          <div class="stat-card-header">
            <div class="stat-card-icon red">
              <svg viewBox="0 0 24 24">
                <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
              </svg>
            </div>
          </div>
          <div class="stat-value">7</div>
          <div class="stat-label">Pending Prosecutions</div>
        </div>
      </div>

      <h2 class="section-title">Quick Actions</h2>
      <div class="cards-grid">
        <a href="/admin/officers" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon">
              <svg viewBox="0 0 24 24">
                <path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </div>
            <div class="action-card-title">Manage Officers</div>
          </div>
          <p class="action-card-desc">Add, edit, or deactivate Food Safety Officers and Designated Officers.</p>
        </a>

        <a href="/admin/reports" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon">
              <svg viewBox="0 0 24 24">
                <path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/>
              </svg>
            </div>
            <div class="action-card-title">Reports & Analytics</div>
          </div>
          <p class="action-card-desc">View inspection reports, sample statistics, and prosecution analytics.</p>
        </a>

        <a href="/admin/settings" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon">
              <svg viewBox="0 0 24 24">
                <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
              </svg>
            </div>
            <div class="action-card-title">System Settings</div>
          </div>
          <p class="action-card-desc">Configure system parameters, notification settings, and integrations.</p>
        </a>

        <a href="/admin/jurisdiction" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #d1fae5;">
              <svg viewBox="0 0 24 24" style="fill: #059669;">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
              </svg>
            </div>
            <div class="action-card-title">Jurisdiction Management</div>
          </div>
          <p class="action-card-desc">Configure administrative levels, jurisdiction units, and officer assignments.</p>
        </a>

        <a href="/admin/templates" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #fef3c7;">
              <svg viewBox="0 0 24 24" style="fill: #d97706;">
                <path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/>
              </svg>
            </div>
            <div class="action-card-title">Document Templates</div>
          </div>
          <p class="action-card-desc">Create and manage document templates with dynamic placeholders for officers.</p>
        </a>

        <a href="/admin/workflow" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #ede9fe;">
              <svg viewBox="0 0 24 24" style="fill: #7c3aed;">
                <path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6zm8-6H8v-2h6v2zm4-4H8V8h10v2z"/>
              </svg>
            </div>
            <div class="action-card-title">Sample Workflow</div>
          </div>
          <p class="action-card-desc">Configure sample lifecycle nodes, transitions, and conditional logic based on lab results.</p>
        </a>

        <a href="/admin/action-dashboard" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #fee2e2;">
              <svg viewBox="0 0 24 24" style="fill: #dc2626;">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
              </svg>
            </div>
            <div class="action-card-title">Action Dashboard</div>
          </div>
          <p class="action-card-desc">Configure action categories, SLA settings, reminders and priority indicators for the mobile dashboard.</p>
        </a>

        <a href="/admin/complaints" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #fce7f3;">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#be185d">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
              </svg>
            </div>
            <div class="action-card-title">Complaint Management</div>
          </div>
          <p class="action-card-desc">Manage complaint form fields, types, natures, status workflows, and view submitted complaints.</p>
        </a>

        <a href="/admin/institutional-inspections" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #dbeafe;">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#1e40af">
                <path d="M12 7V3H2v18h20V7H12zM6 19H4v-2h2v2zm0-4H4v-2h2v2zm0-4H4V9h2v2zm0-4H4V5h2v2zm4 12H8v-2h2v2zm0-4H8v-2h2v2zm0-4H8V9h2v2zm0-4H8V5h2v2zm10 12h-8v-2h2v-2h-2v-2h2v-2h-2V9h8v10zm-2-8h-2v2h2v-2zm0 4h-2v2h2v-2z"/>
              </svg>
            </div>
            <div class="action-card-title">Institutional Inspections</div>
          </div>
          <p class="action-card-desc">Configure person types, pillars, indicators, institution types, and risk thresholds for food safety assessments.</p>
        </a>

        <a href="/admin/fbo-inspections" class="action-card" style="text-decoration: none;">
          <div class="action-card-header">
            <div class="action-card-icon" style="background: #fef3c7;">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#d97706">
                <path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/>
              </svg>
            </div>
            <div class="action-card-title">FBO Inspections</div>
          </div>
          <p class="action-card-desc">Configure inspection types, deviation categories, action types, and settings for FBO inspections.</p>
        </a>
      </div>

      <div class="recent-activity">
        <h2 class="section-title">Recent Activity</h2>
        <ul class="activity-list">
          <li class="activity-item">
            <div class="activity-dot blue"></div>
            <div class="activity-content">
              <div class="activity-text">New inspection submitted by <strong>Rajesh Kumar</strong> in Mumbai Central</div>
              <div class="activity-time">2 hours ago</div>
            </div>
          </li>
          <li class="activity-item">
            <div class="activity-dot green"></div>
            <div class="activity-content">
              <div class="activity-text">Lab report received for sample <strong>MUM-2024-001</strong> - Safe</div>
              <div class="activity-time">5 hours ago</div>
            </div>
          </li>
          <li class="activity-item">
            <div class="activity-dot amber"></div>
            <div class="activity-content">
              <div class="activity-text">Sample <strong>DEL-2024-015</strong> marked as urgent - 2 days until deadline</div>
              <div class="activity-time">Yesterday</div>
            </div>
          </li>
          <li class="activity-item">
            <div class="activity-dot blue"></div>
            <div class="activity-content">
              <div class="activity-text">Officer <strong>Priya Sharma</strong> completed 5 inspections this week</div>
              <div class="activity-time">2 days ago</div>
            </div>
          </li>
        </ul>
      </div>
    </main>

    <script>
      function logout() {
        fetch('/api/admin/logout', { method: 'POST' })
          .then(() => {
            window.location.href = '/admin';
          })
          .catch(() => {
            window.location.href = '/admin';
          });
      }

      (async function checkAuth() {
        try {
          const response = await fetch('/api/admin/check');
          if (!response.ok) {
            window.location.href = '/admin';
          }
        } catch {
          window.location.href = '/admin';
        }
      })();

      (async function loadStats() {
        try {
          const response = await fetch('/api/admin/stats');
          if (response.ok) {
            const stats = await response.json();
            const statCards = document.querySelectorAll('.stat-card');
            if (statCards[0]) statCards[0].querySelector('.stat-value').textContent = stats.activeOfficers;
            if (statCards[1]) statCards[1].querySelector('.stat-value').textContent = stats.totalInspections;
            if (statCards[2]) statCards[2].querySelector('.stat-value').textContent = stats.samplesInTransit;
            if (statCards[3]) statCards[3].querySelector('.stat-value').textContent = stats.pendingProsecutions;
          }
        } catch (e) {
          console.error('Failed to load stats:', e);
        }
      })();
    </script>
  </body>
</html>
